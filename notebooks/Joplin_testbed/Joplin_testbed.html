

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Joplin Tornado Example &#8212; IN-CORE Manual&lt;br /&gt;&lt;span style=&#39;color:grey;font-size:smaller;&#39;&gt;4.6.0&lt;span&gt;</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=c5ced968eda925caa686" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=c5ced968eda925caa686"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Joplin_testbed/Joplin_testbed';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lumberton Testbed" href="../Lumberton_testbed/Lumberton_testbed.html" />
    <link rel="prev" title="Galveston Testbed" href="../Galveston_testbed/Galveston_testbed.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/resilience-logo.png" class="logo__image only-light" alt="IN-CORE Manual<br /><span style='color:grey;font-size:smaller;'>4.6.0<span> - Home"/>
    <script>document.write(`<img src="../../_static/resilience-logo.png" class="logo__image only-dark" alt="IN-CORE Manual<br /><span style='color:grey;font-size:smaller;'>4.6.0<span> - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../introduction.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../account.html">IN-CORE Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../pyincore.html">pyIncore</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../pyincore/quick_reference.html">Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pyincore/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pyincore/install_pyincore.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pyincore_upgrade.html">pyIncore Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pyincore/running.html">Testing and Running</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../analyses.html">Analyses</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/bridge_dmg.html">Bridge damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/building_dmg.html">Building damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/building_func.html">Building functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/building_loss.html">Building Economic Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/capital_shocks.html">Capital shocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/combined_wind_wave_surge_building_dmg.html">Combined wind, wave, surge building damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/cumulative_building_dmg.html">Cumulative building damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/epf_dmg.html">Electric power facility damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/epf_restoration.html">Electric power facility restoration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/epn_functionality.html">EPN functionality analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/housing_household_recovery.html">Household-level housing sequential recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/housing_recovery.html">Housing recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/housingunitallocation.html">Housing unit allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/joplin_cge.html">Joplin Computable General Equilibrium (CGE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/joplin_empirical_restoration.html">Joplin empirical restoration model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/mean_dmg.html">Mean damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/multi_retrofit_optimization.html">Multi-objective retrofit optimization model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/mc_failure_prob.html">Monte Carlo failure probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/nci_functionality.html">Network cascading interdependency functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/non_structural_building_dmg.html">Nonstructural building damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/pipeline_dmg.html">Pipeline damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/pipeline_dmg_w_repair_rate.html">Pipeline damage with repair rate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/pipeline_functionality.html">Pipeline functionality analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/pipeline_restoration.html">Pipeline restoration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/populationdislocation.html">Population dislocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/portfolio_recovery.html">Portfolio recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/residential_building_recovery.html">Residential building recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/road_dmg.html">Road damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/seaside_cge.html">Seaside Computable General Equilibrium (CGE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/social_vulnerability.html">Social vulnerability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/tornadoepn_dmg.html">Tornado electric power network (EPN) damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/transportation_recovery.html">Transportation recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/waterfacility_dmg.html">Water facility damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/wfn_functionality.html">Water network functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../analyses/water_facility_restoration.html">Water facility restoration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../pyincore_viz.html">pyIncore viz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyincore_data.html">pyIncore data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../incore_lab.html">IN-CORE Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../webtools.html">IN-CORE Web Tools</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials.html">Tutorials and Tips</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../create_dataset/create_dataset.html">Create and Use Dataset Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create_dfr3_object/create_dfr3_object.html">Create  DFR3 and Mapping Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create_earthquake/create_earthquake.html">Create Earthquakes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create_tornado/create_tornado.html">Create Tornadoes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../retrofit_plan_Joplin_2021_12_01/retrofit_plan_Joplin_2021_12_01.html">An example of Joplin tornado scenario analysis with Joplin retrofit plan</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create_network_dataset/create_network_dataset.html">Create Network Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../create_local_hazard/create_local_hazard.html">Create Local Hazards</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../workshops.html">IN-CORE workshops</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../workshops/20210526/agenda.html">Workshop May 26, 2021</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session2/session2-hazard.html">Session 2: working with Hazards (Tornado and Earthquake)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session2/session2-assignment.html">Session 2: Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session2/session2-assignment-answer.html">Session 2: Assignment Answer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session3/session3-damage-analysis.html">Session 3: Damage analysis (buildings and electric power facilities)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session3/session3-assignment.html">Session 3: Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session3/session3-assignment-answer.html">Session 3: Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session4/session4-viz.html">Session 4: Visualization of outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session4/session4-assignment.html">Session 4: Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20210526/session4/session4-assignment-answer.html">Session 4: Assignment explanation and answers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../workshops/20220131/agenda.html">Lifeline workshop January 31, 2022</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20220131/session1/session1-jupyter-intro.html">Session 1: Introduction to Jupyter Notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20220131/session2/session2-hazard.html">Session 2: Working with Hazards (Tornado and Earthquake)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20220131/session3/session3-building_damage_analysis.html">Session 3: Building Damage Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../workshops/20220131/session4/session4-damage-analyses-lifelines.html">Session 4: Damage Analyses on Lifelines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../notebooks.html">Example Notebooks</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Galveston_testbed/Galveston_testbed.html">Galveston Testbed</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Joplin Tornado Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Lumberton_testbed/Lumberton_testbed.html">Lumberton Testbed</a></li>

<li class="toctree-l2"><a class="reference internal" href="../Seaside_testbed/Seaside_testbed.html">Seaside Example Notebook 1: Multi-Hazard Building Damage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MMSA_testbed/MMSA_Seismic_Functionality_Analysis_for_Interdependent_Buildings-Water-Power_using_Fragility_and_Repair_Rate_Curves.html">MMSA: Seismic Functionality Analysis for Interdependent Buildings-Water-Power using Fragility and Repair Rate Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MMSA_testbed/MMSA_Seismic_Functionality_and_Restoration_Analysis_for_Interdependent_Buildings-Water-Power_using_Restoration_Curves.html">MMSA: Seismic Functionality and Restoration Analysis for Interdependent Buildings-Water-Power using Restoration Curves</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../notebooks_other.html">Other Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../refs.html">Technical References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../links.html">Useful links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgement.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../termsofservice.html">IN-CORE Terms of Service</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/Joplin_testbed/Joplin_testbed.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Joplin Tornado Example</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hazard-data-and-fragility">1. Hazard, Data, and Fragility</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tornado-path">1.1. Tornado Path</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-archetypes">1.2. Building Archetypes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fragility-curves">1.3. Fragility Curves</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure-damage-analysis">2. Infrastructure Damage Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buildings-damage">2.1. Buildings Damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electrical-power-facility-epf-substations-damage">2.2. Electrical Power Facility (EPF) - Substations Damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electrical-power-facility-epf-poles-damage">2.3. Electrical Power Facility (EPF) - Poles Damage</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-simulation-mcs">3. Monte Carlo Simulation (MCS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcs-chaining-with-joplin-building-damage">3.1. MCS chaining with Joplin building damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcs-chaining-with-joplin-epf-substations-damage">3.2. MCS chaining with Joplin EPF substations damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcs-chaining-with-joplin-epf-poles-damage">3.3. MCS chaining with Joplin EPF poles damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-damage-spatial-distribution-results">3.4. Building Damage Spatial Distribution Results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure-functionality-analysis">4. Infrastructure Functionality Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-functionality-probability">4.1. Building Functionality Probability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-functionality-spatial-distribution-results">4.2. Building Functionality Spatial Distribution Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#physical-service-resilience-metrics">4.3. Physical Service Resilience Metrics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#economic-analysis">5. Economic analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computable-general-equilibrium-cge-model">5.1. Computable General Equilibrium (CGE) Model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#capital-stock-shock-analysis">5.1.2. Capital stock shock analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cge-model">5.1.3. CGE Model</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#economic-resilience-metrics">5.2. Economic Resilience Metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#percent-reduction-of-domestic-supply">5.2.1. Percent Reduction of  Domestic Supply</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-demand-percent-reduction-before-and-after-disaster">5.2.2. Factor demand percent reduction before and after disaster</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#percent-reduction-of-employment">5.2.3. Percent Reduction of Employment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sociological-analysis">6. Sociological Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#population-dislocation-model">6.1. Population Dislocation Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sociological-resilience-metrics">6.2. Sociological Resilience Metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#percent-of-population-dislocation">6.2.1. Percent of Population Dislocation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">7. References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="joplin-tornado-example">
<h1>Joplin Tornado Example<a class="headerlink" href="#joplin-tornado-example" title="Permalink to this heading">#</a></h1>
<p>Please note that you might need additional dependencies to run this notebook, such as <a class="reference external" href="https://anaconda.org/conda-forge/geopandas">geopandas</a> and <a class="reference external" href="https://anaconda.org/conda-forge/contextily">contextily</a></p>
<ul class="simple">
<li><p>Tornadoes occur at a high frequency in the United States compared with other natural hazards such as earthquakes and tsunamis but have a substantially smaller footprint. Even a single high-intensity tornado can result in high casualty rates and catastrophic economic losses and social consequences, particularly for small to medium communities.</p></li>
</ul>
<ul class="simple">
<li><p>The city of Joplin, Missouri, USA, was hit by an EF-5 tornado on May 22, 2011.  The National Institute of Standards and Technology (NIST) conducted a technical investigation of this devastating event which can be found at: https://nvlpubs.nist.gov/nistpubs/NCSTAR/NIST.NCSTAR.3.pdf .  The Center for Risk-Based Community Resilience Planning  simulated this event for buildings and the electrical power network of Joplin in IN-CORE.  This Juypter Notebook provides an example of how to use IN-CORE.</p></li>
</ul>
<ul class="simple">
<li><p>The initial damage prediction utilized the tornado path, tornado fragility curves representative of a 19- archetype building dataset, and EPN datasets.  Generic tornado paths are also available in IN-CORE, or a user defined tornado path is possible.</p></li>
</ul>
<ul class="simple">
<li><p>The functionality of the infrastructure was linked with a computable general equilibrium (CGE) economics model that computes specific community resilience metrics in economic terms.  A population dislocation model provides resilience metrics related to socio-demographics such as population dislocation as a function of income or race/ethnicity.</p></li>
</ul>
<ul class="simple">
<li><p>This example demonstrates how users interact with the IN-CORE computational environment.</p></li>
</ul>
<p>*This notebook was created by Lisa Wang, supervised by Professor John W. van de Lindt, with the help of the NCSA team (Jong Sung Lee, Chris Navarro, Diego Calderon, Chen Wang, Michal Ondrejcek, Gowtham Naraharisetty, and Yong Wook Kim). The population disclocation model was developed by Nathanael Rosenheim and the CGE model portion provided by Brad Hartman under the supervision of Professor Harvey Cutler.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">#</a></h2>
<p>The following modules are necessary to run this notebook. To ensure dependencies are correct, install all modules through <strong>conda</strong>.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Module</p></th>
<th class="head"><p>Version</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>pyIncore</p></td>
<td><p>=&gt;1.3.0</p></td>
<td><p>see: https://incore.ncsa.illinois.edu/doc/incore/install_pyincore.html</p></td>
</tr>
<tr class="row-odd"><td><p>pyIncore_viz</p></td>
<td><p>=&gt;1.5.0</p></td>
<td><p>see: https://incore.ncsa.illinois.edu/doc/pyincore_viz/index.html</p></td>
</tr>
<tr class="row-even"><td><p>matplotlib</p></td>
<td><p>3.1.2</p></td>
<td><p>used for plotting results</p></td>
</tr>
<tr class="row-odd"><td><p>contextily</p></td>
<td><p>0.99.0</p></td>
<td><p>used for context geo-tiles</p></td>
</tr>
<tr class="row-even"><td><p>descartes</p></td>
<td><p>1.1.0</p></td>
<td><p>used for visualization of geometric objects as matplotlib paths</p></td>
</tr>
</tbody>
</table>
<p>Economic Computable General Equilibrium (CGE) Model uses the ipopt solver. The ipopt solver is installed with pyIncore, so the environment should have the solver in it. If you have a trouble to run CGE model later, please see the instruction at CGE section in this document.</p>
</section>
<section id="hazard-data-and-fragility">
<h2>1. Hazard, Data, and Fragility<a class="headerlink" href="#hazard-data-and-fragility" title="Permalink to this heading">#</a></h2>
<p>This section introduces the input for the infrastructure damage analysis including the tornado path, building dataset, and building fragility curves for tornado.</p>
<section id="tornado-path">
<h3>1.1. Tornado Path<a class="headerlink" href="#tornado-path" title="Permalink to this heading">#</a></h3>
<p>This figure shows the 2011 Joplin tornado path with EF zones provided in the legend. The tornado path represents the wind speed within the vortex (multi-vortex in the case of Joplin) that was estimated to have EF5 wind speeds of more than 200 mph, reducing to EF4 wind speeds as the areas move outward from the vortex, and eventually reaching EF1 zone. (Attary et al. 2018)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore</span> <span class="kn">import</span> <span class="n">IncoreClient</span>
<span class="kn">from</span> <span class="nn">pyincore</span> <span class="kn">import</span> <span class="n">FragilityService</span><span class="p">,</span> <span class="n">MappingSet</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">DataService</span>
<span class="kn">from</span> <span class="nn">pyincore_viz.plotutil</span> <span class="kn">import</span> <span class="n">PlotUtil</span> <span class="k">as</span> <span class="n">frag_plot</span>
<span class="kn">from</span> <span class="nn">pyincore_viz.geoutil</span> <span class="kn">import</span> <span class="n">GeoUtil</span> <span class="k">as</span> <span class="n">viz</span>
<span class="kn">from</span> <span class="nn">pyincore.models.fragilitycurveset</span> <span class="kn">import</span> <span class="n">FragilityCurveSet</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">IncoreClient</span><span class="p">()</span>  <span class="c1"># The authentication service validates username/password and  </span>
                         <span class="c1"># approves users to access to other services.&quot;https://incore-dev.ncsa.illinois.edu&quot;</span>
<span class="n">client</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Connection successful to IN-CORE services. pyIncore version detected: 1.7.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tornado_path_id</span> <span class="o">=</span> <span class="s2">&quot;5d07cbeab9219c065b080930&quot;</span>
<span class="n">viz</span><span class="o">.</span><span class="n">plot_tornado</span><span class="p">(</span><span class="n">tornado_path_id</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">basemap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/115ba55be15c6091ad104960de80cdbfe92b2ba5e3022285c5639828f9c178d3.png" src="../../_images/115ba55be15c6091ad104960de80cdbfe92b2ba5e3022285c5639828f9c178d3.png" />
</div>
</div>
</section>
<section id="building-archetypes">
<h3>1.2. Building Archetypes<a class="headerlink" href="#building-archetypes" title="Permalink to this heading">#</a></h3>
<p>The 19 archetype buildings are used herein to represent the Joplin community. The selected building archetypes consider building characteristics such as footprint area, roof structure, number of stories, and so on. (Attary et al. 2018, Memari et al. 2018)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_dataset_id</span> <span class="o">=</span> <span class="s2">&quot;5dbc8478b9219c06dd242c0d&quot;</span>  <span class="c1"># Load the Joplin building dataset.</span>

<span class="n">bldg_dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_data_service</span><span class="p">(</span><span class="n">bldg_dataset_id</span><span class="p">,</span> <span class="n">DataService</span><span class="p">(</span><span class="n">client</span><span class="p">))</span>

<span class="n">viz</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="n">bldg_dataset</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;archetype&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3849a6a2fa8e88e1304a19f5ddd5abaa7f1eed0a82504b759b5f45bf834e0914.png" src="../../_images/3849a6a2fa8e88e1304a19f5ddd5abaa7f1eed0a82504b759b5f45bf834e0914.png" />
</div>
</div>
<p>Joplin building archetypes shown in the Legend above:</p>
<p>1 and 5 - Residential wood building, 6 - Business and retail building, 7 - Light industrial building,
8 - Heavy industrial building, 9 - Elementary/middle school, 10 - High school, 11 - Fire/police station,
12 - Hospital, 13 - Community center/church, 14 - Goverment building, 15 - Large big-box,
16 - Small big-box, 17 - Mobile home, 18 - Shopping center, 19 - Office building</p>
</section>
<section id="fragility-curves">
<h3>1.3. Fragility Curves<a class="headerlink" href="#fragility-curves" title="Permalink to this heading">#</a></h3>
<p>There 19 fragility curves set for these 19 building types in the four damage states, which covers the entire range of wind speeds associated with tornadoes (Attary et al. 2018, Memari et al. 2018). Below we selected 3 types to plot as examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fragility_service</span> <span class="o">=</span> <span class="n">FragilityService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;5d8942dfb9219c068ea795ea&quot;</span>
<span class="n">mapping_set</span> <span class="o">=</span> <span class="n">MappingSet</span><span class="p">(</span><span class="n">fragility_service</span><span class="o">.</span><span class="n">get_mapping</span><span class="p">(</span><span class="n">mapping_id</span><span class="p">))</span>

<span class="c1"># plot fragility for the first 3 archetypes using pyincore viz method</span>
<span class="k">for</span> <span class="n">mapping</span> <span class="ow">in</span> <span class="n">mapping_set</span><span class="o">.</span><span class="n">mappings</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">fragility_id</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;Non-Retrofit Fragility ID Code&#39;</span><span class="p">]</span>
    <span class="n">fragility_set</span> <span class="o">=</span> <span class="n">FragilityCurveSet</span><span class="p">(</span><span class="n">fragility_service</span><span class="o">.</span><span class="n">get_dfr3_set</span><span class="p">(</span><span class="n">fragility_id</span><span class="p">))</span>
    <span class="n">plt</span> <span class="o">=</span> <span class="n">frag_plot</span><span class="o">.</span><span class="n">get_fragility_plot</span><span class="p">(</span><span class="n">fragility_set</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d7505f7ae4130e5779a92767536bca0360186bbf6207f3c0e23bac7151fb102e.png" src="../../_images/d7505f7ae4130e5779a92767536bca0360186bbf6207f3c0e23bac7151fb102e.png" />
<img alt="../../_images/d5aaea71373f9e891d13418776ddccab88974122b4f38c8f01e2583a50a9eb9d.png" src="../../_images/d5aaea71373f9e891d13418776ddccab88974122b4f38c8f01e2583a50a9eb9d.png" />
<img alt="../../_images/f26d110a00dd046202ad8e6ccb896f9c50c659975daf3eab1ef5bb4346e85db6.png" src="../../_images/f26d110a00dd046202ad8e6ccb896f9c50c659975daf3eab1ef5bb4346e85db6.png" />
</div>
</div>
</section>
</section>
<section id="infrastructure-damage-analysis">
<h2>2. Infrastructure Damage Analysis<a class="headerlink" href="#infrastructure-damage-analysis" title="Permalink to this heading">#</a></h2>
<p>The models in this section implement the prediction of community-level damage to the buildings and Electric Power Network (EPN) for the 2011 Joplin tornado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hazard_type</span> <span class="o">=</span> <span class="s2">&quot;tornado&quot;</span>
<span class="n">hazard_id</span> <span class="o">=</span> <span class="s2">&quot;5d07cbeab9219c065b080930&quot;</span>  <span class="c1"># The simulated EF-5 tornado shows geographical locations and the range</span>
                                        <span class="c1"># of wind speed of tornado hazard in Joplin.</span>
</pre></div>
</div>
</div>
</div>
<section id="buildings-damage">
<h3>2.1. Buildings Damage<a class="headerlink" href="#buildings-damage" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.buildingdamage</span> <span class="kn">import</span> <span class="n">BuildingDamage</span>  <span class="c1"># Import building damage module integrated into pyIncore.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;5d8942dfb9219c068ea795ea&quot;</span>       <span class="c1"># Create a mapping to assign tornado fragilities to 19 building archetypes.</span>

<span class="n">fragility_service</span> <span class="o">=</span> <span class="n">FragilityService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>  <span class="c1"># loading fragility mapping</span>
<span class="n">mapping_set</span> <span class="o">=</span> <span class="n">MappingSet</span><span class="p">(</span><span class="n">fragility_service</span><span class="o">.</span><span class="n">get_mapping</span><span class="p">(</span><span class="n">mapping_id</span><span class="p">))</span>

<span class="n">bldg_dmg</span> <span class="o">=</span> <span class="n">BuildingDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> 

<span class="n">building_inv</span> <span class="o">=</span> <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span> <span class="n">bldg_dataset_id</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;dfr3_mapping_set&quot;</span><span class="p">,</span> <span class="n">mapping_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset already exists locally. Reading from local cached zip.
Unzipped folder found in the local cache. Reading from it...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Joplin_bldg_dmg_result&quot;</span>  
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Define the result name, etc., and choose the number of CPU locally </span>
                                      <span class="c1"># to run the model parallelly.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the building damage module to get building damage results for Joplin in a .csv file format. </span>
                         <span class="c1"># The building damage results herein are referred to fragilities at three damage states (moderate, </span>
                         <span class="c1"># heavy, complete) for 28152 buildings located in Joplin that fall within the tornado path or not.</span>
<span class="n">building_dmg_result</span> <span class="o">=</span> <span class="n">bldg_dmg</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;ds_result&#39;</span><span class="p">)</span>

<span class="c1"># Convert dataset to Pandas DataFrame</span>
<span class="n">df_bldg_dmg</span> <span class="o">=</span> <span class="n">building_dmg_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="c1"># Display top 5 rows of output data</span>
<span class="n">df_bldg_dmg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>LS_0</th>
      <th>LS_1</th>
      <th>LS_2</th>
      <th>DS_0</th>
      <th>DS_1</th>
      <th>DS_2</th>
      <th>DS_3</th>
      <th>haz_expose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b497b88f-a4ba-48b1-8438-5cfc68147cfc</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6eadcc3e-7bb5-463a-aca8-f1d16f8ac7cc</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>758fb3de-108a-4e04-895e-fdc4b8627876</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7b706697-bf9b-4883-90f6-862d67a8e64b</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19c91f9b-f679-4263-b7a3-e76fd859c4b1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="electrical-power-facility-epf-substations-damage">
<h3>2.2. Electrical Power Facility (EPF) - Substations Damage<a class="headerlink" href="#electrical-power-facility-epf-substations-damage" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.epfdamage.epfdamage</span> <span class="kn">import</span> <span class="n">EpfDamage</span> <span class="c1"># Import epf damage module integrated into pyIncore.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epf_substations_id</span> <span class="o">=</span> <span class="s2">&quot;5d92355bb9219c06ae7e386a&quot;</span>  
<span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;5d8a326fb9219c068ea798e7&quot;</span>  <span class="c1"># Create a mapping to assign tornado fragilities to substations.</span>

<span class="n">fragility_service</span> <span class="o">=</span> <span class="n">FragilityService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="n">mapping_set</span> <span class="o">=</span> <span class="n">MappingSet</span><span class="p">(</span><span class="n">fragility_service</span><span class="o">.</span><span class="n">get_mapping</span><span class="p">(</span><span class="n">mapping_id</span><span class="p">))</span>

<span class="n">epf_sub_dmg</span> <span class="o">=</span> <span class="n">EpfDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>  

<span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;epfs&quot;</span><span class="p">,</span> <span class="n">epf_substations_id</span><span class="p">)</span> 
                               <span class="c1"># Load the Joplin substations dataset, which is a package of GIS files.</span>
<span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;dfr3_mapping_set&quot;</span><span class="p">,</span> <span class="n">mapping_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Joplin_epf_substations_dmg_result&quot;</span>
<span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
<span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
<span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;fragility_key&quot;</span><span class="p">,</span> <span class="s2">&quot;substations&quot;</span><span class="p">)</span>  <span class="c1"># Define the result name, etc., and choose the number</span>
                                                           <span class="c1"># of CPU locally to run the model parallelly.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the EPF damage module to get substations damage results for Joplin in a .csv file format. The </span>
                            <span class="c1"># substations damage results herein are referred to fragilities at four damage states (insignificant, </span>
                            <span class="c1"># moderate, extensive, complete) for 18 substations located in Joplin that fall within the tornado </span>
                            <span class="c1"># path or not.</span>
<span class="n">substation_dmg_result</span> <span class="o">=</span> <span class="n">epf_sub_dmg</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>

<span class="n">df_sub_dmg</span> <span class="o">=</span> <span class="n">substation_dmg_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">df_sub_dmg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>LS_0</th>
      <th>LS_1</th>
      <th>LS_2</th>
      <th>LS_3</th>
      <th>DS_0</th>
      <th>DS_1</th>
      <th>DS_2</th>
      <th>DS_3</th>
      <th>DS_4</th>
      <th>haz_expose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7f426763-81c6-4cac-b98d-c37a5e439b90</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fc8add00-6760-4752-b1fb-7d6ca813f535</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>e8f4939d-763f-4743-bc61-c23e0b8e0f7a</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2cab48ff-c5ce-495e-9662-67c9a177efc4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>4</th>
      <td>eb4ce929-5164-4ebf-ace2-708096d89db5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="electrical-power-facility-epf-poles-damage">
<h3>2.3. Electrical Power Facility (EPF) - Poles Damage<a class="headerlink" href="#electrical-power-facility-epf-poles-damage" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epf_poles_id</span> <span class="o">=</span> <span class="s2">&quot;5d923daab9219c06ae84afb0&quot;</span>  <span class="c1"># Load the Joplin poles dataset, which is a package of GIS files.</span>
<span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;5d8a326fb9219c068ea798e7&quot;</span>    <span class="c1"># Create a mapping to assign tornado fragilities to poles.</span>

<span class="n">fragility_service</span> <span class="o">=</span> <span class="n">FragilityService</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>        <span class="c1"># loading fragility mapping</span>
<span class="n">mapping_set</span> <span class="o">=</span> <span class="n">MappingSet</span><span class="p">(</span><span class="n">fragility_service</span><span class="o">.</span><span class="n">get_mapping</span><span class="p">(</span><span class="n">mapping_id</span><span class="p">))</span>

<span class="n">epf_poles_dmg</span> <span class="o">=</span> <span class="n">EpfDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> 

<span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;epfs&quot;</span><span class="p">,</span> <span class="n">epf_poles_id</span><span class="p">)</span>

<span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;dfr3_mapping_set&quot;</span><span class="p">,</span> <span class="n">mapping_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Joplin_epf_poles_dmg_result&quot;</span>
<span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
<span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
<span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;fragility_key&quot;</span><span class="p">,</span> <span class="s2">&quot;poles&quot;</span><span class="p">)</span>  <span class="c1"># Define the result name, etc., and choose the number</span>
                                                       <span class="c1"># of CPU locally to run the model parallelly.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the EPF damage module to get poles damage results for Joplin in a .csv file </span>
                              <span class="c1"># format. The poles damage results herein are referred to fragilities at four </span>
                              <span class="c1"># damage states (insignificant, moderate, extensive, complete) for 23857 poles </span>
                              <span class="c1"># located in Joplin that fall within the tornado path or not.</span>
<span class="n">poles_dmg_result</span> <span class="o">=</span> <span class="n">epf_poles_dmg</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>


<span class="n">df_poles_dmg</span> <span class="o">=</span> <span class="n">poles_dmg_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">df_poles_dmg</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>LS_0</th>
      <th>LS_1</th>
      <th>LS_2</th>
      <th>LS_3</th>
      <th>DS_0</th>
      <th>DS_1</th>
      <th>DS_2</th>
      <th>DS_3</th>
      <th>DS_4</th>
      <th>haz_expose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cffe8f2e-9887-456b-9625-5ed122b68c45</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>54efa7ba-475f-4b1d-8821-42d156cb3f7d</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>d0f52ad0-1187-4c0d-9a72-c02687c19778</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>901ae6cb-01d5-4936-a3fe-729d930e76ab</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
    <tr>
      <th>4</th>
      <td>958d0146-1dd5-4b10-8d16-9ec44e7b3010</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="monte-carlo-simulation-mcs">
<h2>3. Monte Carlo Simulation (MCS)<a class="headerlink" href="#monte-carlo-simulation-mcs" title="Permalink to this heading">#</a></h2>
<p>Researchers can use Monte Carlo Simulation to estimate the probability of each building being in a particular damage state.  This example uses 500 iterations to determine the failure probability of buildings reaching damage state 2, damage state 3, and damage state 4. Users can run 10000 samples or even more for a more accurate Monte Carlo Simulation to determine the building failure probabilities.  Note that this takes several minutes and we are working on developing a more efficient algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_samples</span> <span class="o">=</span> <span class="mi">500</span>
</pre></div>
</div>
</div>
</div>
<section id="mcs-chaining-with-joplin-building-damage">
<h3>3.1. MCS chaining with Joplin building damage<a class="headerlink" href="#mcs-chaining-with-joplin-building-damage" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.montecarlofailureprobability</span> <span class="kn">import</span> <span class="n">MonteCarloFailureProbability</span> 
                                                  <span class="c1"># Import Monte Carlo failure probability module integrated into pyIncore.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc_bldg</span> <span class="o">=</span> <span class="n">MonteCarloFailureProbability</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">mc_bldg</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;damage&quot;</span><span class="p">,</span> <span class="n">building_dmg_result</span><span class="p">)</span>  <span class="c1">#  Load the Joplin building damage results dataset </span>
                                                         <span class="c1"># generated from the previous model as an input</span>
<span class="n">mc_bldg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">mc_bldg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_samples&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
<span class="n">mc_bldg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;damage_interval_keys&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DS_0&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_1&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_2&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_3&quot;</span><span class="p">])</span>
<span class="n">mc_bldg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;failure_state_keys&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DS_1&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_2&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_3&quot;</span><span class="p">])</span>

<span class="n">mc_bldg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="s2">&quot;tornado_mc_failure_probability_buildings&quot;</span><span class="p">)</span> <span class="c1"># name of csv file with results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc_bldg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the Monte Carlo Simulation module to obtain the building failure probabilities. The building failure</span>
                       <span class="c1"># probabilities herein only consider the physical damage without the interdependency.</span>

<span class="n">building_failure_probability</span> <span class="o">=</span> <span class="n">mc_bldg</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;failure_probability&#39;</span><span class="p">)</span>  <span class="c1"># get buildings failure probabilities</span>

<span class="n">df_bldg_fail</span> <span class="o">=</span> <span class="n">building_failure_probability</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">df_bldg_fail</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>LS_0</th>
      <th>LS_1</th>
      <th>LS_2</th>
      <th>DS_0</th>
      <th>DS_1</th>
      <th>DS_2</th>
      <th>DS_3</th>
      <th>haz_expose</th>
      <th>failure_probability</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b497b88f-a4ba-48b1-8438-5cfc68147cfc</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6eadcc3e-7bb5-463a-aca8-f1d16f8ac7cc</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>758fb3de-108a-4e04-895e-fdc4b8627876</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7b706697-bf9b-4883-90f6-862d67a8e64b</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19c91f9b-f679-4263-b7a3-e76fd859c4b1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">building_damage_mcs_samples</span> <span class="o">=</span> <span class="n">mc_bldg</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;sample_failure_state&#39;</span><span class="p">)</span>  <span class="c1"># get buildings failure states</span>

<span class="n">bdmcs</span> <span class="o">=</span> <span class="n">building_damage_mcs_samples</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">bdmcs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>failure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b497b88f-a4ba-48b1-8438-5cfc68147cfc</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6eadcc3e-7bb5-463a-aca8-f1d16f8ac7cc</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>758fb3de-108a-4e04-895e-fdc4b8627876</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7b706697-bf9b-4883-90f6-862d67a8e64b</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19c91f9b-f679-4263-b7a3-e76fd859c4b1</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="mcs-chaining-with-joplin-epf-substations-damage">
<h3>3.2. MCS chaining with Joplin EPF substations damage<a class="headerlink" href="#mcs-chaining-with-joplin-epf-substations-damage" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc_sub</span> <span class="o">=</span> <span class="n">MonteCarloFailureProbability</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">mc_sub</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;damage&quot;</span><span class="p">,</span> <span class="n">substation_dmg_result</span><span class="p">)</span>
<span class="n">mc_sub</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">mc_sub</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_samples&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
<span class="n">mc_sub</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;damage_interval_keys&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DS_0&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_1&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_2&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_3&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_4&quot;</span><span class="p">])</span>
<span class="n">mc_sub</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;failure_state_keys&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DS_1&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_2&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_3&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_4&quot;</span><span class="p">])</span>

<span class="n">mc_sub</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Joplin_mcs_substations_samples&quot;</span><span class="p">)</span> <span class="c1"># name of csv file with results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc_sub</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>

<span class="n">substation_damage_mcs_samples</span> <span class="o">=</span> <span class="n">mc_sub</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;sample_failure_state&#39;</span><span class="p">)</span>

<span class="n">sdmcs</span> <span class="o">=</span> <span class="n">substation_damage_mcs_samples</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">sdmcs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>failure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7f426763-81c6-4cac-b98d-c37a5e439b90</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fc8add00-6760-4752-b1fb-7d6ca813f535</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>e8f4939d-763f-4743-bc61-c23e0b8e0f7a</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2cab48ff-c5ce-495e-9662-67c9a177efc4</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>eb4ce929-5164-4ebf-ace2-708096d89db5</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="mcs-chaining-with-joplin-epf-poles-damage">
<h3>3.3. MCS chaining with Joplin EPF poles damage<a class="headerlink" href="#mcs-chaining-with-joplin-epf-poles-damage" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc_pole</span> <span class="o">=</span> <span class="n">MonteCarloFailureProbability</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">mc_pole</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;damage&quot;</span><span class="p">,</span> <span class="n">poles_dmg_result</span><span class="p">)</span>
<span class="n">mc_pole</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">mc_pole</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_samples&quot;</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
<span class="n">mc_pole</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;damage_interval_keys&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DS_0&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_1&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_2&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_3&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_4&quot;</span><span class="p">])</span>
<span class="n">mc_pole</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;failure_state_keys&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DS_1&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_2&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_3&quot;</span><span class="p">,</span> <span class="s2">&quot;DS_4&quot;</span><span class="p">])</span>

<span class="n">mc_pole</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Joplin_mcs_poles_samples&quot;</span><span class="p">)</span> <span class="c1"># name of csv file with results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc_pole</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>

<span class="n">pole_damage_mcs_samples</span> <span class="o">=</span> <span class="n">mc_pole</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;sample_failure_state&#39;</span><span class="p">)</span>

<span class="n">pdmcs</span> <span class="o">=</span> <span class="n">pole_damage_mcs_samples</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">pdmcs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>failure</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cffe8f2e-9887-456b-9625-5ed122b68c45</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>54efa7ba-475f-4b1d-8821-42d156cb3f7d</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>d0f52ad0-1187-4c0d-9a72-c02687c19778</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>901ae6cb-01d5-4936-a3fe-729d930e76ab</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>958d0146-1dd5-4b10-8d16-9ec44e7b3010</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="building-damage-spatial-distribution-results">
<h3>3.4. Building Damage Spatial Distribution Results<a class="headerlink" href="#building-damage-spatial-distribution-results" title="Permalink to this heading">#</a></h3>
<p>Joplin building failure probability map. Legend shows failure probability from 0 to 1 (total) failure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># getting geodataframework of building dataset and merge with output</span>
<span class="n">bldg_gdf</span> <span class="o">=</span> <span class="n">bldg_dataset</span><span class="o">.</span><span class="n">get_dataframe_from_shapefile</span><span class="p">()</span>
<span class="n">bldg_fail_gdf</span> <span class="o">=</span> <span class="n">bldg_gdf</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_bldg_fail</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;guid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viz</span><span class="o">.</span><span class="n">plot_gdf_map</span><span class="p">(</span><span class="n">bldg_fail_gdf</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;failure_probability&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d55cb57338ae0ee511d908f481adb7954d2cf3d56bbdb1b853b8a58ce8ad8f21.png" src="../../_images/d55cb57338ae0ee511d908f481adb7954d2cf3d56bbdb1b853b8a58ce8ad8f21.png" />
</div>
</div>
</section>
</section>
<section id="infrastructure-functionality-analysis">
<h2>4. Infrastructure Functionality Analysis<a class="headerlink" href="#infrastructure-functionality-analysis" title="Permalink to this heading">#</a></h2>
<p>The functionality analysis module below can be used to calculate building functionality probabilities considering two situations: buildings are in at least a damage state 2 or greater or buildings are not damaged but electric power is not available to the building. Whether buildings can receive electrical power is assumed to depend on the interdependency between buildings and substations, and between buildings and poles in close proximity. If both the nearest pole to the building and the substation where buildings belong to its service area are functional, buildings are considered to be able to receive electric power.</p>
<section id="building-functionality-probability">
<h3>4.1. Building Functionality Probability<a class="headerlink" href="#building-functionality-probability" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.buildingfunctionality</span> <span class="kn">import</span> <span class="n">BuildingFunctionality</span>
                                            <span class="c1"># Import building functionality module integrated into pyIncore.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_func</span> <span class="o">=</span> <span class="n">BuildingFunctionality</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="c1"># Load the datasets of building samples, substation samples, and pole samples. All of the samples are randomly </span>
<span class="c1"># generated using the Monte Carlo Simulation module introduced in the previous section.</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;building_damage_mcs_samples&quot;</span><span class="p">,</span> <span class="n">building_damage_mcs_samples</span><span class="p">)</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;substations_damage_mcs_samples&quot;</span><span class="p">,</span> <span class="n">substation_damage_mcs_samples</span><span class="p">)</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;poles_damage_mcs_samples&quot;</span><span class="p">,</span> <span class="n">pole_damage_mcs_samples</span><span class="p">)</span>

<span class="c1"># Load the dataset of the interdependency table between buildings and substations, and between buildings and poles.</span>
<span class="n">interdependency_id</span> <span class="o">=</span> <span class="s2">&quot;5dcf4a34b9219ca5e4118312&quot;</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;interdependency_dictionary&quot;</span><span class="p">,</span> <span class="n">interdependency_id</span><span class="p">)</span>

<span class="n">bldg_func</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Joplin_mcs_functionality_probability&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_func</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the module to obtain the building functionality probabilities.</span>

<span class="n">bldg_func_samples</span> <span class="o">=</span> <span class="n">bldg_func</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;functionality_samples&#39;</span><span class="p">)</span>
<span class="n">df_bldg_samples</span> <span class="o">=</span> <span class="n">bldg_func_samples</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">df_bldg_samples</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>building_guid</th>
      <th>samples</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b497b88f-a4ba-48b1-8438-5cfc68147cfc</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6eadcc3e-7bb5-463a-aca8-f1d16f8ac7cc</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>758fb3de-108a-4e04-895e-fdc4b8627876</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7b706697-bf9b-4883-90f6-862d67a8e64b</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19c91f9b-f679-4263-b7a3-e76fd859c4b1</td>
      <td>1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bldg_func_probability</span> <span class="o">=</span> <span class="n">bldg_func</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;functionality_probability&#39;</span><span class="p">)</span>
<span class="n">df_bldg_func</span> <span class="o">=</span> <span class="n">bldg_func_probability</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">df_bldg_func</span> <span class="o">=</span> <span class="n">df_bldg_func</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;building_guid&quot;</span><span class="p">:</span> <span class="s2">&quot;guid&quot;</span><span class="p">})</span>
<span class="n">df_bldg_func</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>probability</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b497b88f-a4ba-48b1-8438-5cfc68147cfc</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6eadcc3e-7bb5-463a-aca8-f1d16f8ac7cc</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>758fb3de-108a-4e04-895e-fdc4b8627876</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7b706697-bf9b-4883-90f6-862d67a8e64b</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19c91f9b-f679-4263-b7a3-e76fd859c4b1</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="building-functionality-spatial-distribution-results">
<h3>4.2. Building Functionality Spatial Distribution Results<a class="headerlink" href="#building-functionality-spatial-distribution-results" title="Permalink to this heading">#</a></h3>
<p>Joplin building functionality map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># merge building geodataframe with output</span>
<span class="n">bldg_func_gdf</span> <span class="o">=</span> <span class="n">bldg_gdf</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_bldg_func</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;guid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viz</span><span class="o">.</span><span class="n">plot_gdf_map</span><span class="p">(</span><span class="n">bldg_func_gdf</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c64ca8b0d428d5584d5d3d24d17f76fc59c0a73180758812465cae94b3fa92f6.png" src="../../_images/c64ca8b0d428d5584d5d3d24d17f76fc59c0a73180758812465cae94b3fa92f6.png" />
</div>
</div>
</section>
<section id="physical-service-resilience-metrics">
<h3>4.3. Physical Service Resilience Metrics<a class="headerlink" href="#physical-service-resilience-metrics" title="Permalink to this heading">#</a></h3>
<p>After finding the damage level for each component (buildings, substations, and poles) based on the components fragility curves, their intrinsic failure status is expressed as a binary format with either failed (0) or not-failed (1). Then the failure status of all the buildings is updated by considering their dependencies with the corresponding electric power facilities. Each component generates 500 samples randomly with their failure status determined, and the percentage of building functional and nonfunctional could be calculated using the updated status of the same sample (such as sample #1) for all the buildings, illustrated herein as an example.</p>
<p>The percent shown in the horizontal bar below refers to the number of nonfunctional/damaged buildings divided by all buildings in Joplin. For example, the mean percentage of building nonfunctional is around 52%, and the standard deviation percentage shown as an error bar. The percentage is two times more than the percent of building in damage is because three substations fall within the tornado path. Consequently, there is a significant probability for buildings located in their service area cannot be available to access the electric power even though some buildings themselves are still safe and operational in the immediate response of the tornado hazard. It is worthy to note that a random tornado path analysis will produce a larger standard deviation of building damage and building functionality.</p>
<p>Calculate and show all three infrustructure damages and resulting total building funcionality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># buildings damage</span>
<span class="n">bdm</span> <span class="o">=</span> <span class="n">bdmcs</span><span class="p">[</span><span class="s2">&quot;failure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="c1"># strings to integers, change fail to 1</span>
<span class="n">bdm</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">bdm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="c1"># convert panda frame to numpy ndarray and do the statistics</span>
<span class="n">bdm</span> <span class="o">=</span> <span class="n">bdm</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="c1"># convert list of np arrays into single one</span>
<span class="n">bdm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">bdm</span><span class="p">)</span>
<span class="c1"># percent</span>
<span class="n">bdm_guid</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">bdm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bdm_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bdm_guid</span><span class="p">)</span>
<span class="n">bdm_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bdm_guid</span><span class="p">)</span>

<span class="c1"># substations damage</span>
<span class="n">sdm</span> <span class="o">=</span> <span class="n">sdmcs</span><span class="p">[</span><span class="s2">&quot;failure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">sdm</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sdm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">sdm</span> <span class="o">=</span> <span class="n">sdm</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">sdm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">sdm</span><span class="p">)</span>
<span class="n">sdm_guid</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">sdm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sdm_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sdm_guid</span><span class="p">)</span>
<span class="n">sdm_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sdm_guid</span><span class="p">)</span>

<span class="c1"># poles damage</span>
<span class="n">pdm</span> <span class="o">=</span> <span class="n">pdmcs</span><span class="p">[</span><span class="s2">&quot;failure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">pdm</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">pdm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">pdm</span> <span class="o">=</span> <span class="n">pdm</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">pdm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">pdm</span><span class="p">)</span>
<span class="n">pdm_guid</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">pdm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pdm_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pdm_guid</span><span class="p">)</span>
<span class="n">pdm_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">pdm_guid</span><span class="p">)</span>

<span class="c1"># buildings combined functionality</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="n">df_bldg_samples</span><span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">bfm</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">)</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="n">bfm</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">bfm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">bfm</span><span class="p">)</span>
<span class="n">bfm_guid</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">bfm</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">bfm_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bfm_guid</span><span class="p">)</span>
<span class="n">bfm_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">bfm_guid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dataframe from statistical results</span>
<span class="n">infra</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Percent of building nonfunctional&#39;</span><span class="p">,</span> <span class="s1">&#39;Percent of building in damage&#39;</span><span class="p">,</span> <span class="s1">&#39;Percent of substation in damage&#39;</span><span class="p">,</span>\
         <span class="s1">&#39;Percent of pole in damage&#39;</span><span class="p">)</span>
<span class="n">res_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;infrastructure&quot;</span><span class="p">:</span> <span class="n">infra</span><span class="p">,</span>
            <span class="s2">&quot;percentage&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">bfm_mean</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">bdm_mean</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> 
                           <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sdm_mean</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pdm_mean</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
            <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">bfm_std</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">bdm_std</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> 
                    <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sdm_std</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pdm_std</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]}</span>
<span class="n">func_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">func_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                      infrastructure  percentage   std
0  Percent of building nonfunctional       52.07  0.05
1      Percent of building in damage       19.14  0.08
2    Percent of substation in damage       15.61  2.18
3          Percent of pole in damage       15.73  0.01
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">infra</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">res_data</span><span class="p">[</span><span class="s1">&#39;percentage&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">performance</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">res_data</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">infra</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Failures to Infrastructure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Physical Service Resilience Metrics Percentage Change&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Physical service resilience metrics percentage change immediately after the simulated EF-5 tornado.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/12a178e7305821290e1552e16f6b57116d067edfbb87ff367bd5c7704d8e4e09.png" src="../../_images/12a178e7305821290e1552e16f6b57116d067edfbb87ff367bd5c7704d8e4e09.png" />
</div>
</div>
</section>
</section>
<section id="economic-analysis">
<h2>5. Economic analysis<a class="headerlink" href="#economic-analysis" title="Permalink to this heading">#</a></h2>
<section id="computable-general-equilibrium-cge-model">
<h3>5.1. Computable General Equilibrium (CGE) Model<a class="headerlink" href="#computable-general-equilibrium-cge-model" title="Permalink to this heading">#</a></h3>
<p>A computable general equilibrium (CGE) model is based on fundamental economic principles. A CGE model uses multiple data sources to model the interactions of households, firms and relevant government entities as they contribute to economic activity. The model is based on (1) utility-maximizing households that supply labor and capital, using the proceeds to pay for goods and services (both locally produced and imported) and taxes;
(2) the production sector, with perfectly competitive, profit-maximizing firms using intermediate inputs, capital, land and labor to produce goods and services for both domestic consumption and export; (3) the government sector that collects taxes and uses tax revenues in order to finance the provision of public services; and (4) the rest of the world.</p>
<section id="capital-stock-shock-analysis">
<h4>5.1.2. Capital stock shock analysis<a class="headerlink" href="#capital-stock-shock-analysis" title="Permalink to this heading">#</a></h4>
<p>The first step is to aggregate building functionality states and calculates total capital shock losses per sector. We use results of building failure probabilities obtained in previous <strong>MCS chaining with Joplin building damage</strong> section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.capitalshocks</span> <span class="kn">import</span> <span class="n">CapitalShocks</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Joplin building to sector mapping table</span>
<span class="n">building_to_sectors_id</span> <span class="o">=</span> <span class="s2">&quot;5f202d674620b643d787a5e7&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Capital shocks analysis</span>
<span class="n">capital_shocks</span> <span class="o">=</span> <span class="n">CapitalShocks</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="c1"># Load remote datasets</span>
<span class="n">capital_shocks</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;buildings_to_sectors&quot;</span><span class="p">,</span> <span class="n">building_to_sectors_id</span><span class="p">)</span>
<span class="c1"># Set datasets</span>
<span class="c1"># Joplin building inventory</span>
<span class="n">capital_shocks</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span> <span class="n">bldg_dataset_id</span><span class="p">)</span>
<span class="c1"># Joplin building failure probability</span>
<span class="n">capital_shocks</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;failure_probability&quot;</span><span class="p">,</span> <span class="n">building_failure_probability</span><span class="p">)</span>

<span class="n">capital_shocks</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="s2">&quot;sector_shocks&quot;</span><span class="p">)</span> <span class="c1"># name of csv file with results</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset already exists locally. Reading from local cached zip.
Unzipped folder found in the local cache. Reading from it...
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run capital shocks analysis</span>
<span class="n">capital_shocks</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>

<span class="n">sector_shocks_result</span> <span class="o">=</span> <span class="n">capital_shocks</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;sector_shocks&quot;</span><span class="p">)</span>
<span class="n">sector_shocks_result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sector</th>
      <th>shock</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>HS1</td>
      <td>0.758319</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HS2</td>
      <td>0.758741</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GOODS</td>
      <td>0.826290</td>
    </tr>
    <tr>
      <th>3</th>
      <td>OTHER</td>
      <td>0.857213</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TRADE</td>
      <td>0.841259</td>
    </tr>
    <tr>
      <th>5</th>
      <td>HS</td>
      <td>0.990486</td>
    </tr>
    <tr>
      <th>6</th>
      <td>HS3</td>
      <td>0.576333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="cge-model">
<h4>5.1.3. CGE Model<a class="headerlink" href="#cge-model" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.joplincge</span> <span class="kn">import</span> <span class="n">JoplinCGEModel</span>
</pre></div>
</div>
</div>
</div>
<p>Each of the objects with string IDs below refer to datasets used as inputs in the CGE model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># SAM</span>
<span class="c1"># Social accounting matrix (SAM) contains data for firms, households and government which are organized </span>
<span class="c1"># in a way to represent the interactions of all three entities in a typical economy</span>
<span class="n">SAM</span> <span class="o">=</span> <span class="s2">&quot;5dd85ae7b9219c06d4da8de4&quot;</span>

<span class="c1"># CAPITAL COMP</span>
<span class="c1"># BB is a matrix which describes how investment in physical infrastructure is transformed into functioning capital such as commercial and residential buildings. </span>
<span class="c1"># These data are collected from the Bureau of Economic Analysis (BEA).</span>
<span class="n">BB</span> <span class="o">=</span> <span class="s2">&quot;5dc1e620b9219c06dd2f473a&quot;</span>

<span class="c1"># MISC TABLES</span>
<span class="n">IOUT</span> <span class="o">=</span> <span class="s2">&quot;5dc1e6d8b9219c06dd2f475e&quot;</span>  <span class="c1"># This is matrix that describes the transfer of tax revenue collected by the local government to help finance local government expenditures. </span>
<span class="n">MISC</span> <span class="o">=</span> <span class="s2">&quot;5dc1e736b9219c06dd2f4782&quot;</span>  <span class="c1"># This is the name of a file that contains data for commercial sector employment and physical capital. It also contains data for the number of households and working households in the economy. </span>
<span class="n">MISCH</span> <span class="o">=</span> <span class="s2">&quot;5dc1e7b5b9219c06dd2f47a6&quot;</span>  <span class="c1"># A file that contains elasticities for the supply of labor with respect to paying income taxes.</span>
<span class="n">LANDCAP</span> <span class="o">=</span> <span class="s2">&quot;5dc1e810b9219c06dd2f47ca&quot;</span>  <span class="c1"># Contains information regarding elasticity values for the response of changes in the price of physical capital with respect to the supply of investment.</span>
<span class="n">EMPLOY</span> <span class="o">=</span> <span class="s2">&quot;5dc1e85ab9219c06dd2f47ee&quot;</span>  <span class="c1"># Table name containing data for commercial sector employment.</span>
<span class="n">IGTD</span> <span class="o">=</span> <span class="s2">&quot;5dc1e895b9219c06dd2f4812&quot;</span>  <span class="c1"># This variable represents a matrix describing the transfer of taxes collected to a variable which permits governments to spend the tax revenue on workers and intermediate inputs.</span>
<span class="n">TAUFF</span> <span class="o">=</span> <span class="s2">&quot;5dc1e8eeb9219c06dd2f4836&quot;</span>  <span class="c1"># Represents social security tax rates</span>
<span class="n">JOBCR</span> <span class="o">=</span> <span class="s2">&quot;5dc1e962b9219c06dd2f487e&quot;</span>  <span class="c1"># This is a matrix describing the supply of workers coming from each household group in the economy. </span>
<span class="n">OUTCR</span> <span class="o">=</span> <span class="s2">&quot;5dc1e9aeb9219c06dd2f48bc&quot;</span>  <span class="c1"># This a matrix describing the number of workers who live in Joplin but commute outside of town to work.</span>
<span class="n">sector_shocks</span> <span class="o">=</span> <span class="s2">&quot;5f21d40d4620b643d78bb4c2&quot;</span><span class="c1"># This is the aggregation of building functionality states to capital shocks per sector.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Joplin CGE Model</span>
<span class="n">joplin_cge</span> <span class="o">=</span> <span class="n">JoplinCGEModel</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load analysis input datasets</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;SAM&quot;</span><span class="p">,</span> <span class="n">SAM</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;BB&quot;</span><span class="p">,</span> <span class="n">BB</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;IOUT&quot;</span><span class="p">,</span> <span class="n">IOUT</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;MISC&quot;</span><span class="p">,</span> <span class="n">MISC</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;MISCH&quot;</span><span class="p">,</span> <span class="n">MISCH</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;LANDCAP&quot;</span><span class="p">,</span> <span class="n">LANDCAP</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;EMPLOY&quot;</span><span class="p">,</span> <span class="n">EMPLOY</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;IGTD&quot;</span><span class="p">,</span> <span class="n">IGTD</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;TAUFF&quot;</span><span class="p">,</span> <span class="n">TAUFF</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;JOBCR&quot;</span><span class="p">,</span> <span class="n">JOBCR</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;OUTCR&quot;</span><span class="p">,</span> <span class="n">OUTCR</span><span class="p">)</span>

<span class="c1"># Set analysis input dataset from previous Capital stock shock analysis</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;sector_shocks&quot;</span><span class="p">,</span> <span class="n">sector_shocks_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>The ipopt solver is installed with pyIncore, so the environment should have the solver in it, but the solver_path variable lets the user specify a version elsewhere when desired. The variable points to the absolute path for where the ipopt solver is installed. To know the absolute path of the ipopt solver in your local machine, open a terminal window, activate your <strong>pyIncore</strong> environment, and run the following command according to your OS:</p>
<ul class="simple">
<li><p>on Mac: open a terminal window, activate your conda environment and type which ipopt.</p></li>
<li><p>on Windows: open a command terminal, activate your conda environment and type where ipopt.</p></li>
</ul>
<p>and make sure that the folder containing ipopt is in PATH environment of your OS.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set analysis parameters</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;model_iterations&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Joplin CGE model analysis</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ipopt 3.14.9: 

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

This is Ipopt version 3.14.9, running with linear solver MUMPS 5.2.1.

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:    10683

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.7091136e+03 2.47e+02 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.7091147e+03 8.21e+00 2.00e+01  -1.0 3.92e+00    -  9.83e-01 9.90e-01h  1
   2 -1.7091222e+03 8.49e-02 4.91e+03  -1.0 5.90e+00    -  9.90e-01 9.90e-01h  1
   3 -1.7091223e+03 2.49e-06 5.18e+06  -1.0 2.69e+02    -  9.90e-01 1.00e+00h  1
   4 -1.7091223e+03 5.46e-12 1.55e+07  -1.0 2.23e+02    -  9.90e-01 1.00e+00f  1
   5 -1.7091223e+03 2.73e-12 5.80e+04  -1.0 1.86e+00    -  9.91e-01 1.00e+00f  1
   6 -1.7091223e+03 3.64e-12 1.80e-02  -1.0 1.55e-04    -  1.00e+00 1.00e+00h  1
   7 -1.7091223e+03 3.64e-12 1.04e-01  -8.6 3.25e-12    -  1.00e+00 1.00e+00h  1
   8 -1.7091223e+03 5.09e-11 1.13e-12  -8.6 1.16e-06    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 8

                                   (scaled)                 (unscaled)
Objective...............:  -1.7091223190879680e+03   -1.7091223190879680e+03
Dual infeasibility......:   1.1299099113087512e-12    1.1299099113087512e-12
Constraint violation....:   5.0931703299283981e-11    5.0931703299283981e-11
Variable bound violation:   9.2940989592069699e-09    9.2940989592069699e-09
Complementarity.........:   4.3855530815865925e-09    4.3855530815865925e-09
Overall NLP error.......:   4.3855530815865925e-09    4.3855530815865925e-09


Number of objective function evaluations             = 9
Number of objective gradient evaluations             = 9
Number of equality constraint evaluations            = 9
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 9
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 8
Total seconds in IPOPT                               = 0.078

EXIT: Optimal Solution Found.
Ipopt 3.14.9: warm_start_init_point=yes
warm_start_bound_push=1e-06
warm_start_mult_bound_push=1e-06
mu_init=1e-06


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

This is Ipopt version 3.14.9, running with linear solver MUMPS 5.2.1.

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:    10683

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.7091223e+03 9.90e-07 1.00e-06  -6.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.7091223e+03 9.77e-07 9.85e-01  -6.0 1.51e-04    -  1.00e+00 1.29e-02h  1
   2 -1.7091223e+03 6.18e-11 1.94e-06  -6.0 1.19e-06    -  1.00e+00 1.00e+00f  1
   3 -1.7091223e+03 8.55e-11 3.12e-03  -9.0 3.36e-09    -  9.99e-01 1.00e+00h  1
   4 -1.7091223e+03 3.73e-11 1.92e-12  -9.0 7.91e-07    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 4

                                   (scaled)                 (unscaled)
Objective...............:  -1.7091223190994806e+03   -1.7091223190994806e+03
Dual infeasibility......:   1.9157068507622856e-12    1.9157068507622856e-12
Constraint violation....:   3.7289282772690058e-11    3.7289282772690058e-11
Variable bound violation:   9.3806856661851763e-09    9.3806856661851763e-09
Complementarity.........:   1.5420565960073285e-09    1.5420565960073285e-09
Overall NLP error.......:   1.5420565960073285e-09    1.5420565960073285e-09


Number of objective function evaluations             = 5
Number of objective gradient evaluations             = 5
Number of equality constraint evaluations            = 5
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 5
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 4
Total seconds in IPOPT                               = 0.036

EXIT: Optimal Solution Found.
Ipopt 3.14.9: 

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

This is Ipopt version 3.14.9, running with linear solver MUMPS 5.2.1.

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:    10683

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.7091136e+03 4.62e+02 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.6695388e+03 1.85e+02 4.47e+02  -1.0 5.76e+02    -  4.76e-01 6.00e-01h  1
   2 -1.6512571e+03 3.06e+01 1.57e+02  -1.0 2.69e+02    -  7.64e-01 8.34e-01h  1
   3 -1.6482797e+03 7.57e-01 3.23e+02  -1.0 4.97e+01    -  9.68e-01 9.78e-01h  1
   4 -1.6483015e+03 4.87e-02 7.27e+04  -1.0 4.09e+01    -  9.86e-01 9.85e-01h  1
   5 -1.6483067e+03 2.44e-02 2.93e+06  -1.0 3.73e+02    -  9.90e-01 5.00e-01f  2
   6 -1.6483120e+03 8.01e-06 1.02e+07  -1.0 2.87e+02    -  9.90e-01 1.00e+00h  1
   7 -1.6483120e+03 7.28e-12 3.47e+03  -1.0 7.83e-01    -  1.00e+00 1.00e+00h  1
   8 -1.6483120e+03 3.64e-12 8.97e-01  -2.5 4.62e-05    -  1.00e+00 1.00e+00h  1
   9 -1.6483120e+03 5.46e-12 4.22e-04  -5.7 7.46e-07    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -1.6483120e+03 1.36e-11 1.98e-12  -5.7 1.14e-03    -  1.00e+00 1.00e+00h  1
  11 -1.6483120e+03 3.64e-11 2.89e-01  -8.6 3.40e-09    -  9.98e-01 1.00e+00h  1
  12 -1.6483120e+03 4.00e-11 1.64e-12  -8.6 1.15e-06    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 12

                                   (scaled)                 (unscaled)
Objective...............:  -1.6483120219723987e+03   -1.6483120219723987e+03
Dual infeasibility......:   1.6412905286780793e-12    1.6412905286780793e-12
Constraint violation....:   4.0017766878008842e-11    4.0017766878008842e-11
Variable bound violation:   9.9730038639770013e-09    9.9730038639770013e-09
Complementarity.........:   4.9757567244094120e-09    4.9757567244094120e-09
Overall NLP error.......:   4.9757567244094120e-09    4.9757567244094120e-09


Number of objective function evaluations             = 14
Number of objective gradient evaluations             = 13
Number of equality constraint evaluations            = 14
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 13
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 12
Total seconds in IPOPT                               = 0.125

EXIT: Optimal Solution Found.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ipopt 3.14.9: warm_start_init_point=yes
warm_start_bound_push=1e-06
warm_start_mult_bound_push=1e-06
mu_init=1e-06


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

This is Ipopt version 3.14.9, running with linear solver MUMPS 5.2.1.

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:    10683

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.6483120e+03 1.44e-06 1.00e-06  -6.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.6483120e+03 1.43e-06 9.90e-01  -6.0 1.23e-04    -  1.00e+00 7.80e-03f  2
   2 -1.6483120e+03 1.46e-11 1.73e-06  -6.0 9.82e-07    -  1.00e+00 1.00e+00h  1
   3 -1.6483120e+03 8.55e-11 1.24e-02  -9.0 6.20e-09    -  9.94e-01 1.00e+00h  1
   4 -1.6483120e+03 1.46e-11 1.94e-03  -9.0 1.32e-06    -  8.44e-01 4.77e-01h  2
   5 -1.6483120e+03 3.73e-11 2.23e-12  -9.0 8.53e-07    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:  -1.6483120220091955e+03   -1.6483120220091955e+03
Dual infeasibility......:   2.2283610655112365e-12    2.2283610655112365e-12
Constraint violation....:   3.7289282772690058e-11    3.7289282772690058e-11
Variable bound violation:   9.3800434944691157e-09    9.3800434944691157e-09
Complementarity.........:   1.5220742506795684e-09    1.5220742506795684e-09
Overall NLP error.......:   1.5220742506795684e-09    1.5220742506795684e-09


Number of objective function evaluations             = 8
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 8
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total seconds in IPOPT                               = 0.055

EXIT: Optimal Solution Found.
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve result datasets</span>
<span class="n">domestic_supply</span> <span class="o">=</span> <span class="n">joplin_cge</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;domestic-supply&#39;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">domestic_supply</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">ds</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sectors</th>
      <th>DS0</th>
      <th>DSL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Goods</td>
      <td>682.797727</td>
      <td>651.361701</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Trades</td>
      <td>229.636282</td>
      <td>185.309289</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Others</td>
      <td>266.695641</td>
      <td>213.706080</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HS1</td>
      <td>22.018314</td>
      <td>14.020344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HS2</td>
      <td>1361.165027</td>
      <td>1287.722517</td>
    </tr>
    <tr>
      <th>5</th>
      <td>HS3</td>
      <td>477.922693</td>
      <td>448.551704</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gross_income</span> <span class="o">=</span> <span class="n">joplin_cge</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;gross-income&#39;</span><span class="p">)</span>
<span class="n">gi</span> <span class="o">=</span> <span class="n">gross_income</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">gi</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Household Group</th>
      <th>Y0</th>
      <th>YL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>HH1</td>
      <td>12.952321</td>
      <td>12.971429</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HH2</td>
      <td>153.488817</td>
      <td>151.142468</td>
    </tr>
    <tr>
      <th>2</th>
      <td>HH3</td>
      <td>453.061446</td>
      <td>440.297100</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HH4</td>
      <td>438.858832</td>
      <td>413.721728</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HH5</td>
      <td>125.028152</td>
      <td>121.864649</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pre_factor_demand</span> <span class="o">=</span> <span class="n">joplin_cge</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;pre-disaster-factor-demand&#39;</span><span class="p">)</span>
<span class="n">pre_fd</span> <span class="o">=</span> <span class="n">pre_factor_demand</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">pre_fd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Labor Group</th>
      <th>GOODS</th>
      <th>TRADE</th>
      <th>OTHER</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>L1</td>
      <td>449.006038</td>
      <td>2729.055379</td>
      <td>6306.146353</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L2</td>
      <td>3282.049564</td>
      <td>4360.095686</td>
      <td>12396.308192</td>
    </tr>
    <tr>
      <th>2</th>
      <td>L3</td>
      <td>3013.051661</td>
      <td>1851.044407</td>
      <td>5444.146479</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">post_factor_demand</span> <span class="o">=</span> <span class="n">joplin_cge</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;post-disaster-factor-demand&#39;</span><span class="p">)</span>
<span class="n">pos_fd</span> <span class="o">=</span> <span class="n">post_factor_demand</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">pos_fd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Labor Group</th>
      <th>GOODS</th>
      <th>TRADE</th>
      <th>OTHER</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>L1</td>
      <td>439.066323</td>
      <td>2587.859951</td>
      <td>6028.441238</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L2</td>
      <td>3196.460535</td>
      <td>4117.851747</td>
      <td>11802.652398</td>
    </tr>
    <tr>
      <th>2</th>
      <td>L3</td>
      <td>2920.708224</td>
      <td>1739.998637</td>
      <td>5159.105840</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">household_count</span> <span class="o">=</span> <span class="n">joplin_cge</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s1">&#39;household-count&#39;</span><span class="p">)</span>
<span class="n">hc</span> <span class="o">=</span> <span class="n">household_count</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>
<span class="n">hc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Household Group</th>
      <th>HH0</th>
      <th>HHL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>HH1</td>
      <td>3611.010342</td>
      <td>3588.403043</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HH2</td>
      <td>5997.031159</td>
      <td>5930.438188</td>
    </tr>
    <tr>
      <th>2</th>
      <td>HH3</td>
      <td>7544.090149</td>
      <td>7325.799679</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HH4</td>
      <td>2394.098104</td>
      <td>2208.604014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HH5</td>
      <td>793.009003</td>
      <td>766.570521</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="economic-resilience-metrics">
<h3>5.2. Economic Resilience Metrics<a class="headerlink" href="#economic-resilience-metrics" title="Permalink to this heading">#</a></h3>
<section id="percent-reduction-of-domestic-supply">
<h4>5.2.1. Percent Reduction of  Domestic Supply<a class="headerlink" href="#percent-reduction-of-domestic-supply" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">fig_ds</span><span class="p">,</span> <span class="n">ax_ds</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sectors_ds</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Goods&#39;</span><span class="p">,</span> <span class="s1">&#39;Trades&#39;</span><span class="p">,</span> <span class="s1">&#39;Others&#39;</span><span class="p">,</span> <span class="s1">&#39;Housing service 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Housing service 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Housing service 3&#39;</span><span class="p">)</span>
<span class="n">y_pos_ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sectors_ds</span><span class="p">))</span>
<span class="n">perf_ds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;DSL&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;DS0&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># percentage</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">perf_ds</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax_ds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax_ds</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos_ds</span><span class="p">,</span> <span class="n">perf_ds</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax_ds</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos_ds</span><span class="p">)</span>
<span class="n">ax_ds</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">sectors_ds</span><span class="p">)</span>
<span class="n">ax_ds</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax_ds</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Economic Resilience Metrics Percentage Change&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax_ds</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Percent reduction of domestic supply (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">fig_ds</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e252d8d82babf8949fd29e16e2178efb9e04ccc481ea774578154801df82feae.png" src="../../_images/e252d8d82babf8949fd29e16e2178efb9e04ccc481ea774578154801df82feae.png" />
</div>
</div>
</section>
<section id="factor-demand-percent-reduction-before-and-after-disaster">
<h4>5.2.2. Factor demand percent reduction before and after disaster<a class="headerlink" href="#factor-demand-percent-reduction-before-and-after-disaster" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Labor groups</span>
<span class="n">data_pre</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Sectors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;L1&quot;</span><span class="p">,</span> <span class="s2">&quot;L2&quot;</span><span class="p">,</span> <span class="s2">&quot;L3&quot;</span><span class="p">],</span>
            <span class="s2">&quot;GOODS&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">449.006038</span><span class="p">,</span> <span class="mf">3282.049564</span><span class="p">,</span> <span class="mf">3013.051661</span><span class="p">],</span>
            <span class="s2">&quot;TRADE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2729.055379</span><span class="p">,</span> <span class="mf">4360.095686</span><span class="p">,</span> <span class="mf">1851.044407</span><span class="p">],</span>
            <span class="s2">&quot;OTHER&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6306.146353</span><span class="p">,</span> <span class="mf">12396.308192</span><span class="p">,</span> <span class="mf">5444.146479</span><span class="p">]}</span>
<span class="n">pre_fd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_pre</span><span class="p">)</span>
<span class="n">data_pos</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Sectors&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;L1&quot;</span><span class="p">,</span> <span class="s2">&quot;L2&quot;</span><span class="p">,</span> <span class="s2">&quot;L3&quot;</span><span class="p">],</span>
            <span class="s2">&quot;GOODS&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">438.913649</span><span class="p">,</span> <span class="mf">3195.254485</span><span class="p">,</span> <span class="mf">2919.538642</span><span class="p">],</span>
            <span class="s2">&quot;TRADE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2586.192593</span><span class="p">,</span> <span class="mf">4115.076833</span><span class="p">,</span> <span class="mf">1738.785852</span><span class="p">],</span>
            <span class="s2">&quot;OTHER&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6026.389334</span><span class="p">,</span> <span class="mf">11798.285962</span><span class="p">,</span> <span class="mf">5157.077844</span><span class="p">]}</span>
<span class="n">pos_fd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_pos</span><span class="p">)</span>

<span class="n">perf_gd</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pos_fd</span><span class="p">[</span><span class="s1">&#39;GOODS&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pre_fd</span><span class="p">[</span><span class="s1">&#39;GOODS&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># percentage</span>
<span class="n">perf_tr</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pos_fd</span><span class="p">[</span><span class="s1">&#39;TRADE&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pre_fd</span><span class="p">[</span><span class="s1">&#39;TRADE&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">perf_ot</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pos_fd</span><span class="p">[</span><span class="s1">&#39;OTHER&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pre_fd</span><span class="p">[</span><span class="s1">&#39;OTHER&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Labor groups</span>
<span class="n">labor_groups</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span> <span class="s1">&#39;L2&#39;</span><span class="p">,</span> <span class="s1">&#39;L3&#39;</span><span class="p">)</span>
<span class="n">goods</span> <span class="o">=</span> <span class="n">perf_gd</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">trade</span> <span class="o">=</span> <span class="n">perf_tr</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">other</span> <span class="o">=</span> <span class="n">perf_ot</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">y_pos_fd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labor_groups</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;goods&#39;</span><span class="p">:</span> <span class="n">goods</span><span class="p">,</span> <span class="s1">&#39;trade&#39;</span><span class="p">:</span> <span class="n">trade</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">:</span> <span class="n">other</span><span class="p">},</span> <span class="n">index</span> <span class="o">=</span> <span class="n">labor_groups</span><span class="p">)</span>
<span class="n">ax_fd</span> <span class="o">=</span> <span class="n">df_all</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">perf_gd</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax_fd</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">0.15</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">perf_tr</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax_fd</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">perf_ot</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax_fd</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">0.25</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax_fd</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos_fd</span><span class="p">)</span>
<span class="n">ax_fd</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labor_groups</span><span class="p">)</span>
<span class="n">ax_fd</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax_fd</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Factor demand reduction (%)&#39;</span><span class="p">)</span>
<span class="n">ax_fd</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Factor demand after disaster&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6477567b10ae3b6d77b05918950a78b0271b5e19144a6bbb4eb73d9a5b38739d.png" src="../../_images/6477567b10ae3b6d77b05918950a78b0271b5e19144a6bbb4eb73d9a5b38739d.png" />
</div>
</div>
</section>
<section id="percent-reduction-of-employment">
<h4>5.2.3. Percent Reduction of Employment<a class="headerlink" href="#percent-reduction-of-employment" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">fig_hc</span><span class="p">,</span> <span class="n">ax_hc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">household_hc</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;HH1 (less than $15,000)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH2 ($15,000 to 24,999)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH3 ($25,000 to 74,999)&#39;</span><span class="p">,</span>
                <span class="s1">&#39;HH4 ($75,000 to 99,999)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH5 ($100,000 or more)&#39;</span><span class="p">)</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">household_hc</span><span class="p">))</span>
<span class="n">perf_hc</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hc</span><span class="p">[</span><span class="s1">&#39;HHL&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">hc</span><span class="p">[</span><span class="s1">&#39;HH0&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># percentage</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">perf_hc</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax_hc</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax_hc</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">perf_hc</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax_hc</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
<span class="n">ax_hc</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">household_hc</span><span class="p">)</span>
<span class="n">ax_hc</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax_hc</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Economic Resilience Metrics Percentage Change&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax_hc</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Percent reduction of employment (%)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">fig_hc</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/baef70d156d9d807b0c9199f351fe831f2c64f6c090d1bd64e5f4b11829997a8.png" src="../../_images/baef70d156d9d807b0c9199f351fe831f2c64f6c090d1bd64e5f4b11829997a8.png" />
</div>
</div>
</section>
</section>
</section>
<section id="sociological-analysis">
<h2>6. Sociological Analysis<a class="headerlink" href="#sociological-analysis" title="Permalink to this heading">#</a></h2>
<p>This section introduces the sociology-based analysis which may be integrated with hazard and building damage analysis. In this example the damage to buildings drives the population dislocation algorithm at the household level.</p>
<section id="population-dislocation-model">
<h3>6.1. Population Dislocation Model<a class="headerlink" href="#population-dislocation-model" title="Permalink to this heading">#</a></h3>
<p>The population dislocation model depends first on the allocation of detailed housing unit and household characteristic data to each residential building within the community. The allocation of detailed household characteristic data provides an estimate of the number of people that live within each structure. The dislocation model is based on household surveys, for a more detailed summary of the dislocation model please refer to Rosenheim, Guidotti, Gardoni, and Peacock 2019.</p>
<p>The model predicts which households within the community will be dislocated from their homes immediately following the hazard event.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.populationdislocation</span> <span class="kn">import</span> <span class="n">PopulationDislocation</span><span class="p">,</span> <span class="n">PopulationDislocationUtil</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">housing_unit_alloc</span> <span class="o">=</span> <span class="s2">&quot;5dc1c196b9219c06dd2e3f0b&quot;</span>
<span class="n">bg_data</span> <span class="o">=</span> <span class="s2">&quot;5d4c9545b9219c0689b2358a&quot;</span>
<span class="n">value_loss</span> <span class="o">=</span> <span class="s2">&quot;60354810e379f22e16560dbd&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Population dislocation analysis</span>
<span class="n">pop_dis</span> <span class="o">=</span> <span class="n">PopulationDislocation</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load analysis input datasets</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;housing_unit_allocation&quot;</span><span class="p">,</span> <span class="n">housing_unit_alloc</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;block_group_data&quot;</span><span class="p">,</span> <span class="n">bg_data</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;value_loss_param&quot;</span><span class="p">,</span> <span class="n">value_loss</span><span class="p">)</span>

<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_input_dataset</span><span class="p">(</span><span class="s2">&quot;building_dmg&quot;</span><span class="p">,</span> <span class="n">building_dmg_result</span><span class="p">)</span>  <span class="c1"># Load the Joplin building damage results dataset </span>
                                                                <span class="c1"># generated from the previous model as an input</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;pop-dislocation-results&quot;</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">1111</span>

<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_dis</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>

<span class="c1"># Retrieve result dataset</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pop_dis</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>

<span class="c1"># Convert dataset to Pandas DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">(</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>guid</th>
      <th>DS_0</th>
      <th>DS_1</th>
      <th>DS_2</th>
      <th>DS_3</th>
      <th>haz_expose</th>
      <th>strctid</th>
      <th>statefp10</th>
      <th>tractce10</th>
      <th>pumgeoid10</th>
      <th>...</th>
      <th>bgyear</th>
      <th>pblackbg</th>
      <th>phispbg</th>
      <th>d_sf</th>
      <th>rploss_0</th>
      <th>rploss_1</th>
      <th>rploss_2</th>
      <th>rploss_3</th>
      <th>prdis</th>
      <th>dislocated</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59fc3532-2c7d-4d68-b7d5-5a7b6ed4a556</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>S0021177</td>
      <td>29.0</td>
      <td>10100.0</td>
      <td>2902800.0</td>
      <td>...</td>
      <td>2010.0</td>
      <td>7.269338</td>
      <td>3.075489</td>
      <td>1</td>
      <td>0.002914</td>
      <td>0.100425</td>
      <td>0.524702</td>
      <td>0.889881</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>535a461c-f028-4e05-9100-43541b645f1c</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>S0023095</td>
      <td>29.0</td>
      <td>10100.0</td>
      <td>2902800.0</td>
      <td>...</td>
      <td>2010.0</td>
      <td>7.269338</td>
      <td>3.075489</td>
      <td>1</td>
      <td>0.006930</td>
      <td>0.132025</td>
      <td>0.677548</td>
      <td>0.951019</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38688790-543b-4a28-9530-49975d353de4</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>S0021178</td>
      <td>29.0</td>
      <td>10100.0</td>
      <td>2902800.0</td>
      <td>...</td>
      <td>2010.0</td>
      <td>7.269338</td>
      <td>3.075489</td>
      <td>1</td>
      <td>0.005776</td>
      <td>0.100000</td>
      <td>0.654935</td>
      <td>0.941974</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>e791aea5-706d-4e59-b4e9-0eada663b6c7</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>S0023093</td>
      <td>29.0</td>
      <td>10100.0</td>
      <td>2902800.0</td>
      <td>...</td>
      <td>2010.0</td>
      <td>7.269338</td>
      <td>3.075489</td>
      <td>1</td>
      <td>0.002404</td>
      <td>0.105851</td>
      <td>0.436479</td>
      <td>0.854591</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>46b98fd2-f0d0-4ef4-9de3-ea1798e93050</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>no</td>
      <td>S0023044</td>
      <td>29.0</td>
      <td>10100.0</td>
      <td>2902800.0</td>
      <td>...</td>
      <td>2010.0</td>
      <td>7.269338</td>
      <td>3.075489</td>
      <td>1</td>
      <td>0.003029</td>
      <td>0.133077</td>
      <td>0.438777</td>
      <td>0.855511</td>
      <td>0.0</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows  84 columns</p>
</div></div></div>
</div>
</section>
<section id="sociological-resilience-metrics">
<h3>6.2. Sociological Resilience Metrics<a class="headerlink" href="#sociological-resilience-metrics" title="Permalink to this heading">#</a></h3>
<section id="percent-of-population-dislocation">
<h4>6.2.1. Percent of Population Dislocation<a class="headerlink" href="#percent-of-population-dislocation" title="Permalink to this heading">#</a></h4>
<p>The PopulationDislocation model predicts the probability of dislocation using a logistic regression model based on household level surveys from Hurricane Andrew in 1992, which was a major wind event. The logistic regression equation provides a probability of dislocation based on the value loss and the other factors. For more details on the population dislocation algorithm and the logistic regression model see Rosenheim et al 2019.</p>
<p>To determine if a household dislocate a random value was uniformly sampled between 0 and 1: if this value was lower than the probability of dislocation, then the household was set to dislocate. The results below provide one example of how the output can be explored by population subgroups. The model is designed to run as part of a larger Monte Carlo Simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">pop_dis</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">(</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># Select Housing units allocated to buildings</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_title</span> <span class="o">=</span> <span class="s2">&quot;Total population by tenure status and dislocation.&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ownershp&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dislocated&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;numprec&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">,</span>
            <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins_name</span><span class="o">=</span><span class="s2">&quot;Total&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="n">table_title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_bce47">
  <caption>Total population by tenure status and dislocation.</caption>
  <thead>
    <tr>
      <th class="index_name level0" >dislocated</th>
      <th id="T_bce47_level0_col0" class="col_heading level0 col0" >False</th>
      <th id="T_bce47_level0_col1" class="col_heading level0 col1" >True</th>
      <th id="T_bce47_level0_col2" class="col_heading level0 col2" >Total</th>
    </tr>
    <tr>
      <th class="index_name level0" >ownershp</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_bce47_level0_row0" class="row_heading level0 row0" >1.000000</th>
      <td id="T_bce47_row0_col0" class="data row0 col0" >111769.000000</td>
      <td id="T_bce47_row0_col1" class="data row0 col1" >5690.000000</td>
      <td id="T_bce47_row0_col2" class="data row0 col2" >117459.000000</td>
    </tr>
    <tr>
      <th id="T_bce47_level0_row1" class="row_heading level0 row1" >2.000000</th>
      <td id="T_bce47_row1_col0" class="data row1 col0" >49015.000000</td>
      <td id="T_bce47_row1_col1" class="data row1 col1" >4752.000000</td>
      <td id="T_bce47_row1_col2" class="data row1 col2" >53767.000000</td>
    </tr>
    <tr>
      <th id="T_bce47_level0_row2" class="row_heading level0 row2" >Total</th>
      <td id="T_bce47_row2_col0" class="data row2 col0" >160784.000000</td>
      <td id="T_bce47_row2_col1" class="data row2 col1" >10442.000000</td>
      <td id="T_bce47_row2_col2" class="data row2 col2" >171226.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_title</span> <span class="o">=</span> <span class="s2">&quot;Percent population by tenure status and dislocation.&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ownershp&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dislocated&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;numprec&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
            <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins_name</span><span class="o">=</span><span class="s2">&quot;Total&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>dislocated</th>
      <th>False</th>
      <th>True</th>
    </tr>
    <tr>
      <th>ownershp</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>95.16</td>
      <td>4.84</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>91.16</td>
      <td>8.84</td>
    </tr>
    <tr>
      <th>Total</th>
      <td>93.90</td>
      <td>6.10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The variable ownershp represents the tenure status of households. When ownershp = 1 the housing unit is owner-occupied. When the ownershp = 2 the housing unit is renter-occupied.
The results above provide the percent of the population predicted to dislocate based on tenure status. When the variable dislocated = True the household is predicted to dislocate.</p>
</section>
</section>
</section>
<section id="references">
<h2>7. References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<p>Attary, N., van de Lindt, J. W., Mahmoud, H., Smith, S., Navarro, C. M., Kim, Y. W., &amp; Lee, J. S. (2018). Hindcasting community-level building damage for the 2011 Joplin EF5 tornado. Natural Hazards, 93(3), 1295-1316.</p>
<p>Attary, N., van de Lindt, J. W., Mahmoud, H., &amp; Smith, S. (2018). Hindcasting Community-Level Damage to the Interdependent Buildings and Electric Power Network after the 2011 Joplin, Missouri, Tornado. Natural Hazards Review, 20(1), 04018027.</p>
<p>Memari, M., Attary, N., Masoomi, H., Mahmoud, H., van de Lindt, J. W., Pilkington, S. F., &amp; Ameri, M. R. (2018). Minimal building fragility portfolio for damage assessment of communities subjected to tornadoes. Journal of Structural Engineering, 144(7), 04018072.</p>
<p>Guidotti, R., Gardoni, P., &amp; Rosenheim, N. (2019). Integration of physical infrastructure and social systems in communities reliability and resilience analysis. Reliability Engineering &amp; System Safety, 185, 476-492. https://doi.org/10.1016/j.ress.2019.01.008</p>
<p>Rosenheim, N., Guidotti, R., Gardoni, P., &amp; Peacock, W. (2019). Integration of detailed household and housing unit characteristic data with critical infrastructure for post-hazard resilience modeling. Sustainable and Resilient Infrastructure. https://doi.org/10.1080/23789689.2019.1681821</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/Joplin_testbed"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../Galveston_testbed/Galveston_testbed.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Galveston Testbed</p>
      </div>
    </a>
    <a class="right-next"
       href="../Lumberton_testbed/Lumberton_testbed.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lumberton Testbed</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hazard-data-and-fragility">1. Hazard, Data, and Fragility</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tornado-path">1.1. Tornado Path</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-archetypes">1.2. Building Archetypes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fragility-curves">1.3. Fragility Curves</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure-damage-analysis">2. Infrastructure Damage Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#buildings-damage">2.1. Buildings Damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electrical-power-facility-epf-substations-damage">2.2. Electrical Power Facility (EPF) - Substations Damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electrical-power-facility-epf-poles-damage">2.3. Electrical Power Facility (EPF) - Poles Damage</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monte-carlo-simulation-mcs">3. Monte Carlo Simulation (MCS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcs-chaining-with-joplin-building-damage">3.1. MCS chaining with Joplin building damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcs-chaining-with-joplin-epf-substations-damage">3.2. MCS chaining with Joplin EPF substations damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mcs-chaining-with-joplin-epf-poles-damage">3.3. MCS chaining with Joplin EPF poles damage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-damage-spatial-distribution-results">3.4. Building Damage Spatial Distribution Results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure-functionality-analysis">4. Infrastructure Functionality Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-functionality-probability">4.1. Building Functionality Probability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#building-functionality-spatial-distribution-results">4.2. Building Functionality Spatial Distribution Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#physical-service-resilience-metrics">4.3. Physical Service Resilience Metrics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#economic-analysis">5. Economic analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computable-general-equilibrium-cge-model">5.1. Computable General Equilibrium (CGE) Model</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#capital-stock-shock-analysis">5.1.2. Capital stock shock analysis</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cge-model">5.1.3. CGE Model</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#economic-resilience-metrics">5.2. Economic Resilience Metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#percent-reduction-of-domestic-supply">5.2.1. Percent Reduction of  Domestic Supply</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-demand-percent-reduction-before-and-after-disaster">5.2.2. Factor demand percent reduction before and after disaster</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#percent-reduction-of-employment">5.2.3. Percent Reduction of Employment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sociological-analysis">6. Sociological Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#population-dislocation-model">6.1. Population Dislocation Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sociological-resilience-metrics">6.2. Sociological Resilience Metrics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#percent-of-population-dislocation">6.2.1. Percent of Population Dislocation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">7. References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By IN-CORE Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>